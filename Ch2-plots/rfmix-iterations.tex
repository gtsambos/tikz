\documentclass{article} % say
\usepackage{tikz,pdflscape}
\usetikzlibrary{calc}


\begin{document}
\tikzset{pop1/.style={blue!40},pop2/.style={red!40}}

\begin{landscape}
    
\begin{tikzpicture}[scale=0.2,auto]

% Step nodes
\node (s1) at (0,0)   {};
\node (s2) at (0,-15) {};
\node (s3) at (0,-30) {};

% Row nodes
\node (r1) at (0,0)   {};
\node (r2) at (0, -3) {};
\node (r3) at (0, -6) {};

% Column nodes
\node (c1) at (0,0)   {};
\node (c2) at (12, 0) {};
\node (c3) at (24, 0) {};

% Sample nodes
\node (ref) at (0,0)  {};
\node (adm) at (50,0) {};

% Chromosome size
\node (chr) at (10,2) {};

%%%% Chromosome painting

%  Step 1
\filldraw[pop1,draw=black] ($(s1) + (ref) + (r1) + (c2)$) rectangle +(chr);
\filldraw[pop1,draw=black] ($(s1) + (ref) + (r2) + (c2)$) rectangle +(chr);
\filldraw[pop1,draw=black] ($(s1) + (ref) + (r3) + (c2)$) rectangle +(chr);
\fill[pop2,draw=black]  ($(s1) + (ref) + (r1) + (c3)$) rectangle +(chr);
\fill[pop2,draw=black]  ($(s1) + (ref) + (r2) + (c3)$) rectangle +(chr);
\fill[pop2,draw=black]  ($(s1) + (ref) + (r3) + (c3)$) rectangle +(chr);

%declare function={
%	adm11(\c) = {
%		%\node (a11) at ($(s1) + (adm) + (r2) + (c1)$) {};
%		\fill[pop2] ($\c + (0,0)$) rectangle ($\c + (chr)$);
%		\fill[pop1] ($\c + (2,0)$) rectangle ($\c + (chr)$);
%		\fill[pop2] ($\c + (5,0)$) rectangle ($\c + (chr)$);
%		\fill[pop1] ($\c + (9,0)$) rectangle ($\c + (chr)$);
%		\draw ($(a11) + (0,0)$) rectangle ($\c + (chr)$);
%	}
%}



\node (a11) at ($(s1) + (adm) + (r2) + (c1)$) {};
\fill[pop2] ($(a11) + (0,0)$) rectangle ($(a11) + (chr)$);
\fill[pop1] ($(a11) + (2,0)$) rectangle ($(a11) + (chr)$);
\fill[pop2] ($(a11) + (5,0)$) rectangle ($(a11) + (chr)$);
\fill[pop1] ($(a11) + (9,0)$) rectangle ($(a11) + (chr)$);
\draw ($(a11) + (0,0)$) rectangle ($(a11) + (chr)$);

\node (a21) at ($(s1) + (adm) + (r3) + (c1)$) {};
\fill[pop1]  ($(a21) + (0,0)$) rectangle ($(a21) + (chr)$);
\fill[pop2]  ($(a21) + (3,0)$) rectangle ($(a21) + (chr)$);
\draw ($(a21) + (0,0)$) rectangle ($(a21) + (chr)$);


% Step 2

\node (a11) at ($(s2) + (ref) + (r2) + (c1)$) {};
\fill[pop2] ($(a11) + (0,0)$) rectangle ($(a11) + (chr)$);
\fill[pop1] ($(a11) + (2,0)$) rectangle ($(a11) + (chr)$);
\fill[pop2] ($(a11) + (5,0)$) rectangle ($(a11) + (chr)$);
\fill[pop1] ($(a11) + (9,0)$) rectangle ($(a11) + (chr)$);
\draw ($(a11) + (0,0)$) rectangle ($(a11) + (chr)$);

\node (a21) at ($(s2) + (ref) + (r3) + (c1)$) {};
\fill[pop1]  ($(a21) + (0,0)$) rectangle ($(a21) + (chr)$);
\fill[pop2]  ($(a21) + (3,0)$) rectangle ($(a21) + (chr)$);
\draw ($(a21) + (0,0)$) rectangle ($(a21) + (chr)$);

\filldraw[pop1,draw=black] ($(s2) + (ref) + (r1) + (c2)$) rectangle +(chr);
\filldraw[pop1,draw=black] ($(s2) + (ref) + (r2) + (c2)$) rectangle +(chr);
\filldraw[pop1,draw=black] ($(s2) + (ref) + (r3) + (c2)$) rectangle +(chr);
\fill[pop2,draw=black]  ($(s2) + (ref) + (r1) + (c3)$) rectangle +(chr);
\fill[pop2,draw=black]  ($(s2) + (ref) + (r2) + (c3)$) rectangle +(chr);
\fill[pop2,draw=black]  ($(s2) + (ref) + (r3) + (c3)$) rectangle +(chr);


\node (a11) at ($(s2) + (adm) + (r2) + (c1)$) {};
\fill[pop2] ($(a11) + (0,0)$) rectangle ($(a11) + (chr)$);
\fill[pop1] ($(a11) + (2,0)$) rectangle ($(a11) + (chr)$);
\fill[pop2] ($(a11) + (5,0)$) rectangle ($(a11) + (chr)$);
\fill[pop1] ($(a11) + (9,0)$) rectangle ($(a11) + (chr)$);
\draw ($(a11) + (0,0)$) rectangle ($(a11) + (chr)$);

\node (a21) at ($(s2) + (adm) + (r3) + (c1)$) {};
\fill[pop1]  ($(a21) + (0,0)$) rectangle ($(a21) + (chr)$);
\fill[pop2]  ($(a21) + (3,0)$) rectangle ($(a21) + (chr)$);
\fill[pop1]  ($(a21) + (9,0)$) rectangle ($(a21) + (chr)$);
\draw ($(a21) + (0,0)$) rectangle ($(a21) + (chr)$);

\fill[pop1,draw=black] ($(s2) + (adm) + (r1) + (c2)$) rectangle +(chr);
\fill[pop1,draw=black] ($(s2) + (adm) + (r2) + (c2)$) rectangle +(chr);
\fill[pop1,draw=black] ($(s2) + (adm) + (r3) + (c2)$) rectangle +(chr);

\fill[pop2,draw=black]  ($(s2) + (adm) + (r1) + (c3)$) rectangle +(chr);

\node (a23) at ($(s2) + (adm) + (r2) + (c3)$) {};
\fill[pop1]  ($(a23) + (0,0)$) rectangle ($(a23) + (chr)$);
\fill[pop2]  ($(a23) + (2,0)$) rectangle ($(a23) + (chr)$);
\draw ($(a23) + (0,0)$) rectangle ($(a23) + (chr)$);

\fill[pop2,draw=black]  ($(s2) + (adm) + (r3) + (c3)$) rectangle +(chr);


% Step 3

\node (a11) at ($(s3) + (ref) + (r2) + (c1)$) {};
\fill[pop2] ($(a11) + (0,0)$) rectangle ($(a11) + (chr)$);
\fill[pop1] ($(a11) + (2,0)$) rectangle ($(a11) + (chr)$);
\fill[pop2] ($(a11) + (5,0)$) rectangle ($(a11) + (chr)$);
\fill[pop1] ($(a11) + (9,0)$) rectangle ($(a11) + (chr)$);
\draw ($(a11) + (0,0)$) rectangle ($(a11) + (chr)$);

\node (a21) at ($(s3) + (ref) + (r3) + (c1)$) {};
\fill[pop1]  ($(a21) + (0,0)$) rectangle ($(a21) + (chr)$);
\fill[pop2]  ($(a21) + (3,0)$) rectangle ($(a21) + (chr)$);
\draw ($(a21) + (0,0)$) rectangle ($(a21) + (chr)$);

\fill[pop1,draw=black] ($(s3) + (ref) + (r1) + (c2)$) rectangle +(chr);
\fill[pop1,draw=black] ($(s3) + (ref) + (r2) + (c2)$) rectangle +(chr);
\fill[pop1,draw=black] ($(s3) + (ref) + (r3) + (c2)$) rectangle +(chr);

\fill[pop2,draw=black]  ($(s3) + (ref) + (r1) + (c3)$) rectangle +(chr);

\node (a23) at ($(s3) + (ref) + (r2) + (c3)$) {};
\fill[pop1]  ($(a23) + (0,0)$) rectangle ($(a23) + (chr)$);
\fill[pop2]  ($(a23) + (2,0)$) rectangle ($(a23) + (chr)$);
\draw ($(a23) + (0,0)$) rectangle ($(a23) + (chr)$);

\fill[pop2,draw=black]  ($(s3) + (ref) + (r3) + (c3)$) rectangle +(chr);

\node (a11) at ($(s3) + (adm) + (r2) + (c1)$) {};
\fill[pop1] ($(a11) + (0,0)$) rectangle ($(a11) + (chr)$);
\fill[pop2] ($(a11) + (5,0)$) rectangle ($(a11) + (chr)$);
\fill[pop1] ($(a11) + (9,0)$) rectangle ($(a11) + (chr)$);
\draw ($(a11) + (0,0)$) rectangle ($(a11) + (chr)$);

\node (a21) at ($(s3) + (adm) + (r3) + (c1)$) {};
\fill[pop1]  ($(a21) + (0,0)$) rectangle ($(a21) + (chr)$);
\fill[pop2]  ($(a21) + (3,0)$) rectangle ($(a21) + (chr)$);
\fill[pop1]  ($(a21) + (9,0)$) rectangle ($(a21) + (chr)$);
\draw ($(a21) + (0,0)$) rectangle ($(a21) + (chr)$); 

\fill[pop1,draw=black] ($(s3) + (adm) + (r1) + (c2)$) rectangle +(chr);
\fill[pop1,draw=black] ($(s3) + (adm) + (r2) + (c2)$) rectangle +(chr);
\fill[pop1,draw=black] ($(s3) + (adm) + (r3) + (c2)$) rectangle +(chr);

\fill[pop2,draw=black]  ($(s3) + (adm) + (r1) + (c3)$) rectangle +(chr);

\node (a23) at ($(s3) + (adm) + (r2) + (c3)$) {};
\fill[pop1]  ($(a23) + (0,0)$) rectangle ($(a23) + (chr)$);
\fill[pop2]  ($(a23) + (2,0)$) rectangle ($(a23) + (chr)$);
\draw ($(a23) + (0,0)$) rectangle ($(a23) + (chr)$);

\fill[pop2,draw=black]  ($(s3) + (adm) + (r3) + (c3)$) rectangle +(chr);


%%%%% Labels

\draw ($(s1) + (r1) + (c1) + (ref) + (-2,0)$) node[anchor=east] {{\bf Step 1. }};
\draw ($(s2) + (r1) + (c1) + (ref) + (-2,0)$) node[anchor=east] {{\bf Step 2. }};
\draw ($(s3) + (r1) + (c1) + (ref) + (-2,0)$) node[anchor=east] {{\bf Step 3. }};

\draw ($(s1) + (r1) + (c2) + (ref) + (0,4)$) node[anchor=south] {{\bf Training chromosomes}};
\draw ($(s1) + (r1) + (c2) + (adm) + (0,4)$) node[anchor=south] {{\bf Test chromosomes}};


%%%%% Arrows

\node (start) at ($(s1) + (r2) + (c3) + (ref) + (10,0) + (1,0)$) {};
\node (end)   at ($(s1) + (r2) + (c1) + (adm) + (-1,0)$) {};
\draw[->,bend left=45] (start) to node {{\scriptsize inference}} node [swap] {} (end); 

\node (start) at ($(s2) + (r2) + (c3) + (ref) + (10,0) + (1,0)$) {};
\node (end)   at ($(s2) + (r2) + (c1) + (adm) + (-1,0)$) {};
\draw[->,bend left=45] (start) to node {{\scriptsize inference}} node [swap] {} (end); 

\node (start) at ($(s3) + (r2) + (c3) + (ref) + (10,0) + (1,0)$) {};
\node (end)   at ($(s3) + (r2) + (c1) + (adm) + (-1,0)$) {};
\draw[->,bend left=45] (start) to node {{\scriptsize inference}} node [swap] {} (end); 

\end{tikzpicture}  

\end{landscape}  


\end{document}